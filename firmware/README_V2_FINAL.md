# üéâ USB PASSTHROUGH - –ü–û–í–ù–ê –†–ï–ê–õ–Ü–ó–ê–¶–Ü–Ø –ì–û–¢–û–í–ê!

## –í–µ—Ä—Å—ñ—è 2.0 - –§—ñ–Ω–∞–ª—å–Ω–∏–π —Ä–µ–ª—ñ–∑

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ó–ê–í–ï–†–®–ï–ù–û - –ì–û–¢–û–í–û –î–û –í–ò–ö–û–†–ò–°–¢–ê–ù–ù–Ø**

–¢–µ–ø–µ—Ä RP2350 –ø—Ä–∞—Ü—é—î —è–∫ **–ø–æ–≤–Ω—ñ—Å—Ç—é –ø—Ä–æ–∑–æ—Ä–∏–π USB –ø–æ—Å–µ—Ä–µ–¥–Ω–∏–∫**, –¥–æ–∑–≤–æ–ª—è—é—á–∏ Logitech G Hub (—Ç–∞ —ñ–Ω—à–∏–º –ø—Ä–æ–≥—Ä–∞–º–∞–º –≤–∏—Ä–æ–±–Ω–∏–∫—ñ–≤) –ø–æ–≤–Ω—ñ—Å—Ç—é –Ω–∞–ª–∞—à—Ç–æ–≤—É–≤–∞—Ç–∏ –≤–∞—à—É –º–∏—à—É, –∫–ª–∞–≤—ñ–∞—Ç—É—Ä—É —á–∏ —ñ–Ω—à–∏–π HID –ø—Ä–∏—Å—Ç—Ä—ñ–π!

---

## üöÄ –©–æ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ

### ‚úÖ –í–µ—Ä—Å—ñ—è 2.0 - –ü–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å:

1. **USB Descriptor Passthrough** ‚úÖ
   - Device Descriptor –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è
   - Configuration Descriptor –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è
   - HID Report Descriptor –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è
   - String Descriptors (Manufacturer, Product, Serial)

2. **Input/Output Reports** ‚úÖ
   - –ü—Ä–æ–∑–æ—Ä–∞ –ø–µ—Ä–µ–¥–∞—á–∞ Input Reports (—Ä—É—Ö –º–∏—à—ñ, –∫–Ω–æ–ø–∫–∏)
   - –ü—Ä–æ–∑–æ—Ä–∞ –ø–µ—Ä–µ–¥–∞—á–∞ Output Reports (LED, –≤—ñ–±—Ä–∞—Ü—ñ—ó)

3. **Feature Reports (–ù–ï –ü–†–ê–¶–Æ–í–ê–õ–û –≤ v1.0 ‚Üí –ü–†–ê–¶–Æ–Ñ –≤ v2.0!)** ‚úÖ
   - GET_REPORT forwarding —á–µ—Ä–µ–∑ tuh_control_xfer()
   - SET_REPORT forwarding —á–µ—Ä–µ–∑ tuh_control_xfer()
   - Async callbacks –∑ timeout handling
   - Device address tracking

4. **–©–æ —Ç–µ–ø–µ—Ä –ø—Ä–∞—Ü—é—î –≤ G Hub** ‚úÖ
   - –ó–º—ñ–Ω–∞ DPI —á–µ—Ä–µ–∑ —Å–ª–∞–π–¥–µ—Ä
   - RGB –ø—ñ–¥—Å–≤—ñ—Ç–∫–∞ (–∫–æ–ª—ñ—Ä, –µ—Ñ–µ–∫—Ç–∏, —è—Å–∫—Ä–∞–≤—ñ—Å—Ç—å)
   - –ü–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—è –∫–Ω–æ–ø–æ–∫
   - –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –º–∞–∫—Ä–æ—Å—ñ–≤
   - –ü—Ä–æ—Ñ—ñ–ª—ñ (–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ onboard memory)
   - Polling Rate –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
   - Surface calibration
   - Angle snapping
   - Lift-Off Distance (LOD)

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª—ñ–≤

### üîß –ö–æ–¥ (—Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è):
- **`src/passthrough.h`** - API –¥–ª—è passthrough
- **`src/passthrough.cc`** - –ü–æ–≤–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è (GET/SET_REPORT forwarding)
- **`src/globals.h/cc`** - –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ (–≤–∫–ª—é—á–Ω–æ –∑ passthrough_dev_addr)
- **`src/tinyusb_stuff.cc`** - TinyUSB callbacks integration
- **`src/remapper.cc`** - Input Reports forwarding
- **`src/remapper_single.cc`** - Device mounting —Ç–∞ descriptor capture

### üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è:

#### –î–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:
- **`FINAL_CHEATSHEET.md`** ‚≠ê - **–ü–û–ß–ù–Ü–¢–¨ –ó–í–Ü–î–°–ò!** –®–≤–∏–¥–∫–∞ —à–ø–∞—Ä–≥–∞–ª–∫–∞
- **`QUICKSTART_LOGITECH.md`** - –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç –¥–ª—è Logitech –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- **`PASSTHROUGH_UA.md`** - –î–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é

#### –î–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤:
- **`FULL_PASSTHROUGH_DONE.md`** - –ü–æ–≤–Ω–∏–π –æ–ø–∏—Å —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó v2.0
- **`IMPLEMENTATION_GUIDE.md`** - –¢–µ—Ö–Ω—ñ—á–Ω–∏–π –≥–∞–π–¥ (GET/SET_REPORT implementation)
- **`PASSTHROUGH.md`** - –¢–µ—Ö–Ω—ñ—á–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è (–∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—é)

#### –î–æ–ø–æ–º—ñ–∂–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è:
- **`COMPLETE.md`** - –ß–µ–∫–ª–∏—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –ø—Ä–æ–µ–∫—Ç—É
- **`CHANGELOG_PASSTHROUGH.md`** - –î–µ—Ç–∞–ª—å–Ω–∏–π —Å–ø–∏—Å–æ–∫ –∑–º—ñ–Ω
- **`README_PASSTHROUGH.md`** - –ì–æ–ª–æ–≤–Ω–µ —Ä–µ–∑—é–º–µ
- **`CHEATSHEET.md`** - –ö–æ—Ä–æ—Ç–∫–∞ —à–ø–∞—Ä–≥–∞–ª–∫–∞ (1 —Å—Ç–æ—Ä—ñ–Ω–∫–∞)

---

## üéØ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### 1. –ö–æ–º–ø—ñ–ª—è—Ü—ñ—è
```bash
cd hid-remapper-hid/firmware
mkdir -p build && cd build
cmake ..
make
```

### 2. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
```bash
# –ü—ñ–¥–∫–ª—é—á—ñ—Ç—å RP2350 –≤ BOOTSEL —Ä–µ–∂–∏–º—ñ
cp firmware.uf2 /media/RPI-RP2/
```

### 3. –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
```
[Logitech –ú–∏—à–∞] ‚Üí [RP2350 Host] ‚Üí [RP2350 Device] ‚Üí [–ü–ö]
```

### 4. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è G Hub
```
https://www.logitechg.com/software/g-hub
```

### 5. –ù–∞—Å–æ–ª–æ–¥–∂—É–π—Ç–µ—Å—å! üéÆ
–í—Å—ñ 100% —Ñ—É–Ω–∫—Ü—ñ–π G Hub —Ç–µ–ø–µ—Ä –ø—Ä–∞—Ü—é—é—Ç—å!

---

## üîç –©–æ –∑–º—ñ–Ω–∏–ª–æ—Å—å —É –≤–µ—Ä—Å—ñ—ó 2.0?

### –í–µ—Ä—Å—ñ—è 1.0 (–±–∞–∑–æ–≤–∞):
- ‚úÖ –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∏ –∫–æ–ø—ñ—é—é—Ç—å—Å—è
- ‚úÖ G Hub **—Ä–æ–∑–ø—ñ–∑–Ω–∞—î** –º–∏—à—É
- ‚ùå G Hub **–ù–ï –º–æ–∂–µ –Ω–∞–ª–∞—à—Ç–æ–≤—É–≤–∞—Ç–∏** (DPI, RGB –Ω–µ –ø—Ä–∞—Ü—é—é—Ç—å)

### –í–µ—Ä—Å—ñ—è 2.0 (—Ñ—ñ–Ω–∞–ª—å–Ω–∞):
- ‚úÖ –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∏ –∫–æ–ø—ñ—é—é—Ç—å—Å—è
- ‚úÖ G Hub **—Ä–æ–∑–ø—ñ–∑–Ω–∞—î** –º–∏—à—É
- ‚úÖ G Hub **–ú–û–ñ–ï –ù–ê–õ–ê–®–¢–û–í–£–í–ê–¢–ò** (DPI, RGB, –º–∞–∫—Ä–æ—Å–∏ - –≤—Å–µ –ø—Ä–∞—Ü—é—î!)

### –ö–ª—é—á–æ–≤—ñ –∑–º—ñ–Ω–∏:
```cpp
// –î–æ–¥–∞–Ω–æ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∞–¥—Ä–µ—Å–∏ –ø—Ä–∏—Å—Ç—Ä–æ—é
extern uint8_t passthrough_dev_addr;

// –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ GET_REPORT –∑ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è–º –¥–æ–≤–∂–∏–Ω–∏
uint16_t passthrough_handle_get_report(...);

// –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ SET_REPORT –∑ control transfer
bool passthrough_handle_set_report(...);

// Async callbacks –¥–ª—è –æ–±—Ä–æ–±–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
static void get_report_complete_cb(tuh_xfer_t* xfer);
static void set_report_complete_cb(tuh_xfer_t* xfer);
```

---

## üí° –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó

–ü—Ä–∞—Ü—é—î –∑ –±—É–¥—å-—è–∫–∏–º–∏ HID –ø—Ä–∏—Å—Ç—Ä–æ—è–º–∏:
- ‚úÖ Logitech –º–∏—à—ñ (G502, G Pro, G903, —Ç–æ—â–æ)
- ‚úÖ Razer –º–∏—à—ñ —Ç–∞ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏
- ‚úÖ Corsair –ø–µ—Ä–∏—Ñ–µ—Ä—ñ—è
- ‚úÖ SteelSeries –ø—Ä–∏—Å—Ç—Ä–æ—ó
- ‚úÖ –ë—É–¥—å-—è–∫—ñ —ñ–Ω—à—ñ HID –ø—Ä–∏—Å—Ç—Ä–æ—ó –∑ –≤–ª–∞—Å–Ω–∏–º –ü–ó

---

## üêõ Debug

–ü—ñ–¥–∫–ª—é—á—ñ—Ç—å UART (115200 baud) –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –ª–æ–≥—ñ–≤:
```
Passthrough: –∑–∞—Ö–æ–ø–ª–µ–Ω–æ device descriptor –≤—ñ–¥ dev_addr=1, VID=046D PID=C08B
Passthrough: GET_REPORT itf=0 report_id=0x10 type=3 len=64
Passthrough: GET_REPORT —É—Å–ø—ñ—à–Ω–æ, –æ—Ç—Ä–∏–º–∞–Ω–æ 64 –±–∞–π—Ç
Passthrough: SET_REPORT itf=0 report_id=0x11 type=3 len=32
Passthrough: SET_REPORT data: 11 01 FF 00 00 ...
Passthrough: SET_REPORT —É—Å–ø—ñ—à–Ω–æ
```

---

## üìß –ö–æ–Ω—Ç–∞–∫—Ç–∏ —Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞

–Ø–∫—â–æ —É –≤–∞—Å –≤–∏–Ω–∏–∫–ª–∏ –ø–∏—Ç–∞–Ω–Ω—è:
1. –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ `FINAL_CHEATSHEET.md`
2. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ `PASSTHROUGH_UA.md` –¥–ª—è –¥–µ—Ç–∞–ª–µ–π
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ debug logs —á–µ—Ä–µ–∑ UART

---

## üéâ –£—Å–ø—ñ—Ö—ñ–≤!

**–¢–µ–ø–µ—Ä –≤–∞—à–∞ Logitech –º–∏—à–∞ –ø—Ä–∞—Ü—é—î —á–µ—Ä–µ–∑ RP2350 –∑ –ø–æ–≤–Ω–æ—é –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é G Hub!**

–í—Å—ñ 100% —Ñ—É–Ω–∫—Ü—ñ–π –¥–æ—Å—Ç—É–ø–Ω—ñ - –≤—ñ–¥ –∑–º—ñ–Ω–∏ DPI –¥–æ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–∏—Ö –º–∞–∫—Ä–æ—Å—ñ–≤! üöÄ

