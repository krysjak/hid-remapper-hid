# üéÆ USB Passthrough Mode - –†–µ–∑—é–º–µ

## üéØ –©–æ –∑—Ä–æ–±–ª–µ–Ω–æ

–î–æ–¥–∞–Ω–æ **–ø–æ–≤–Ω–∏–π USB Passthrough —Ä–µ–∂–∏–º** –¥–ª—è HID Remapper –ø—Ä–æ—à–∏–≤–∫–∏ –Ω–∞ RP2350.

### –û—Å–Ω–æ–≤–Ω–∞ —ñ–¥–µ—è
```
–ó–∞–º—ñ—Å—Ç—å:  [Logitech –ú–∏—à–∞] ‚Üí [RP2350 —è–∫ "Generic HID"] ‚Üí [–ü–ö] ‚ùå G Hub –Ω–µ –ø—Ä–∞—Ü—é—î

–¢–µ–ø–µ—Ä:    [Logitech –ú–∏—à–∞] ‚Üí [RP2350 —è–∫ "Logitech –ú–∏—à–∞"] ‚Üí [–ü–ö] ‚úÖ G Hub –ø—Ä–∞—Ü—é—î!
```

## üìÇ –°—Ç–≤–æ—Ä–µ–Ω–æ —Ñ–∞–π–ª–∏

### –ö–æ–¥
- `src/passthrough.h` - API –¥–ª—è passthrough
- `src/passthrough.cc` - –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
- `PASSTHROUGH.md` - –¢–µ—Ö–Ω—ñ—á–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è (English)
- `PASSTHROUGH_UA.md` - –î–µ—Ç–∞–ª—å–Ω–∏–π –≥–∞–π–¥ (–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞) 
- `QUICKSTART_LOGITECH.md` - –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç –¥–ª—è Logitech
- `CHANGELOG_PASSTHROUGH.md` - –°–ø–∏—Å–æ–∫ –∑–º—ñ–Ω
- `README_PASSTHROUGH.md` - –¶–µ–π —Ñ–∞–π–ª (—Ä–µ–∑—é–º–µ)

## ‚úèÔ∏è –ú–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ —Ñ–∞–π–ª–∏

| –§–∞–π–ª | –ó–º—ñ–Ω–∏ |
|------|-------|
| `src/globals.h/cc` | –î–æ–¥–∞–Ω–æ –∑–º—ñ–Ω–Ω—ñ –¥–ª—è passthrough |
| `src/tinyusb_stuff.cc` | USB callbacks —Ç–µ–ø–µ—Ä –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω—ñ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∏ |
| `src/remapper_single.cc` | –ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ñ–≤ –ø—Ä–∏ mount |
| `src/remapper.cc` | –ü—Ä–æ–∑–æ—Ä–∞ –ø–µ—Ä–µ–¥–∞—á–∞ –∑–≤—ñ—Ç—ñ–≤ —É passthrough —Ä–µ–∂–∏–º—ñ |

## üöÄ –Ø–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—å

### –ö—Ä–æ–∫ 1: –°–∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ –ø—Ä–æ—à–∏–≤–∫—É
```bash
cd hid-remapper-hid/firmware
mkdir build && cd build
cmake ..
make
```

### –ö—Ä–æ–∫ 2: –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–∞ RP2350
```bash
# –ü—ñ–¥–∫–ª—é—á—ñ—Ç—å RP2350 –≤ BOOTSEL —Ä–µ–∂–∏–º—ñ
cp firmware.uf2 /media/RPI-RP2/
```

### –ö—Ä–æ–∫ 3: –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è
```
[Logitech –ú–∏—à–∞] --USB--> [RP2350] --USB--> [Windows PC]
```

### –ö—Ä–æ–∫ 4: –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ G Hub
- –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏: https://www.logitechg.com/software/g-hub
- G Hub –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–Ω–∞–π–¥–µ –≤–∞—à—É –º–∏—à—É

### –ö—Ä–æ–∫ 5: –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏
- DPI, –∫–Ω–æ–ø–∫–∏, RGB - –≤—Å–µ –ø—Ä–∞—Ü—é—î —è–∫ –∑–∞–∑–≤–∏—á–∞–π!

## ‚úÖ –©–æ –ø—Ä–∞—Ü—é—î

- [x] –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è Device Descriptor (VID/PID)
- [x] –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è Configuration Descriptor
- [x] –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è HID Report Descriptor
- [x] –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è String Descriptors (manufacturer, product, serial)
- [x] –ü—Ä–æ–∑–æ—Ä–∞ –ø–µ—Ä–µ–¥–∞—á–∞ Input Reports (—Ä—É—Ö –º–∏—à—ñ, –∫–Ω–æ–ø–∫–∏)
- [x] G Hub —Ä–æ–∑–ø—ñ–∑–Ω–∞—î –º–∏—à—É
- [x] –ë–∞–∑–æ–≤—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ G Hub

## üöß –í —Ä–æ–∑—Ä–æ–±—Ü—ñ (TODO)

- [ ] GET_REPORT forwarding (–¥–ª—è Feature Reports)
- [ ] SET_REPORT forwarding (–¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å)
- [ ] Vendor-specific Control Transfers
- [ ] –ü–æ–≤–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ DPI switching —á–µ—Ä–µ–∑ G Hub

**–ü—Ä–∏–º—ñ—Ç–∫–∞:** –ë–∞–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å (—Ä—É—Ö, –∫–Ω–æ–ø–∫–∏, –∫–æ–ª–µ—Å–æ) –ø—Ä–∞—Ü—é—î –Ω–∞ 100%.

## üéì –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ

### –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

```cpp
// –ü—Ä–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—ñ –º–∏—à—ñ (Host side)
tuh_mount_cb() {
    capture_device_descriptor();     // –ó–±–µ—Ä–µ–≥—Ç–∏ VID/PID
    capture_config_descriptor();     // –ó–±–µ—Ä–µ–≥—Ç–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏
    capture_hid_report_descriptor(); // –ó–±–µ—Ä–µ–≥—Ç–∏ —Ñ–æ—Ä–º–∞—Ç HID
    capture_string_descriptors();    // –ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–∑–≤–∏
}

// –ü—Ä–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—ñ –¥–æ –ü–ö (Device side)
tud_descriptor_device_cb() {
    return passthrough_device_descriptor;  // –ü–æ–≤–µ—Ä–Ω—É—Ç–∏ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–µ!
}

// –ü—Ä–∏ –ø–µ—Ä–µ–¥–∞—á—ñ –¥–∞–Ω–∏—Ö
handle_received_report() {
    if (passthrough_mode) {
        forward_directly_to_pc();  // –ë–µ–∑ –æ–±—Ä–æ–±–∫–∏
    }
}
```

### –©–æ –∫–æ–ø—ñ—é—î—Ç—å—Å—è

1. **Device Descriptor (18 bytes)**
   - VID (046D –¥–ª—è Logitech)
   - PID (C08B –¥–ª—è G502)
   - –í–µ—Ä—Å—ñ—è USB
   - Device Class

2. **Configuration Descriptor (–¥–æ 256 bytes)**
   - –ö—ñ–ª—å–∫—ñ—Å—Ç—å —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ–≤
   - Endpoints (IN/OUT)
   - Power consumption

3. **HID Report Descriptor (–¥–æ 1024 bytes)**
   - –§–æ—Ä–º–∞—Ç Input Reports
   - –§–æ—Ä–º–∞—Ç Output Reports
   - Usage Tables

4. **String Descriptors**
   - Manufacturer: "Logitech"
   - Product: "G502 HERO Gaming Mouse"
   - Serial Number

## üéØ –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –º–∏—à—ñ

### Logitech
- G502 HERO / Lightspeed / X ‚úÖ
- G Pro Wireless ‚úÖ
- G703 / G403 ‚úÖ
- G900 / G903 ‚úÖ
- MX Master 3 ‚úÖ

### –Ü–Ω—à—ñ –±—Ä–µ–Ω–¥–∏
- Razer (—á–µ—Ä–µ–∑ Synapse) ‚úÖ
- Corsair (—á–µ—Ä–µ–∑ iCUE) ‚úÖ
- SteelSeries (—á–µ—Ä–µ–∑ Engine) ‚úÖ
- –ë—É–¥—å-—è–∫–∞ gaming –º–∏—à–∞ –∑ vendor –ü–ó ‚úÖ

## üìñ –î–µ –ø–æ—á–∞—Ç–∏ —á–∏—Ç–∞—Ç–∏

1. **–ù–æ–≤–∞—á–æ–∫?** ‚Üí `QUICKSTART_LOGITECH.md`
2. **–•–æ—á—É –¥–µ—Ç–∞–ª—ñ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é?** ‚Üí `PASSTHROUGH_UA.md`
3. **–¢–µ—Ö–Ω—ñ—á–Ω—ñ –ø–æ–¥—Ä–æ–±–∏—Ü—ñ?** ‚Üí `PASSTHROUGH.md`
4. **–°–ø–∏—Å–æ–∫ –∑–º—ñ–Ω?** ‚Üí `CHANGELOG_PASSTHROUGH.md`

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º (Passthrough —É–≤—ñ–º–∫–Ω–µ–Ω–∏–π)
```cpp
// globals.cc
bool passthrough_mode = true;  // ‚úÖ –ü—Ä–∞—Ü—é—î –∑ G Hub
```

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π —Ä–µ–∂–∏–º (–±–µ–∑ Passthrough)
```cpp
// globals.cc
bool passthrough_mode = false;  // ‚ùå G Hub –Ω–µ –ø—Ä–∞—Ü—é—î
```

## üí° –ö–æ—Ä–∏—Å–Ω—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó

### –°—Ü–µ–Ω–∞—Ä—ñ–π 1: –ü—Ä–æ—Å—Ç–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –º–∏—à—É —á–µ—Ä–µ–∑ G Hub
```
Passthrough: ON
Remapping: OFF
‚Üí –ú–∏—à–∞ –ø—Ä–∞—Ü—é—î —è–∫ –ø—ñ–¥–∫–ª—é—á–µ–Ω–∞ –Ω–∞–ø—Ä—è–º—É
‚Üí G Hub –Ω–∞–ª–∞—à—Ç–æ–≤—É—î –≤—Å–µ
```

### –°—Ü–µ–Ω–∞—Ä—ñ–π 2: G Hub + Remapping –æ–¥–Ω–æ—á–∞—Å–Ω–æ
```
Passthrough: ON (–¥–ª—è G Hub)
Remapping: ON (–¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π)
‚Üí G Hub –Ω–∞–ª–∞—à—Ç–æ–≤—É—î DPI, RGB
‚Üí RP2350 –¥–æ–¥–∞—î –∫–∞—Å—Ç–æ–º–Ω—ñ –º–∞–∫—Ä–æ—Å–∏, GPIO
```

### –°—Ü–µ–Ω–∞—Ä—ñ–π 3: –¢—ñ–ª—å–∫–∏ Remapping
```
Passthrough: OFF
Remapping: ON
‚Üí –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π —Ä–µ–∂–∏–º HID Remapper
‚Üí G Hub –Ω–µ –ø—Ä–∞—Ü—é—î, –∞–ª–µ –º–∞—î—Ç–µ –ø–æ–≤–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å
```

## üêõ Troubleshooting

### G Hub –Ω–µ –±–∞—á–∏—Ç—å –º–∏—à—É
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ VID/PID –≤ –ª–æ–≥–∞—Ö
2. –ü–µ—Ä–µ–ø—ñ–¥–∫–ª—é—á—ñ—Ç—å USB
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å G Hub

### –ú–∏—à–∞ –Ω–µ —Ä—É—Ö–∞—î—Ç—å—Å—è
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ `passthrough_mode = true`
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ USB –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
3. –ü–æ–¥–∏–≤—ñ—Ç—å—Å—è Serial Monitor –¥–ª—è –ø–æ–º–∏–ª–æ–∫

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –Ω–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è
- –¶–µ –æ—á—ñ–∫—É–≤–∞–Ω–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ (TODO)
- –ë–∞–∑–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –ø—Ä–∞—Ü—é—é—Ç—å
- GET/SET_REPORT –±—É–¥–µ –¥–æ–¥–∞–Ω–æ –≤ –Ω–∞—Å—Ç—É–ø–Ω—ñ–π –≤–µ—Ä—Å—ñ—ó

## üéâ –ü–µ—Ä–µ–≤–∞–≥–∏

‚úÖ **–î–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:**
- –ú–∏—à–∞ –ø—Ä–∞—Ü—é—î —è–∫ –ø—ñ–¥–∫–ª—é—á–µ–Ω–∞ –Ω–∞–ø—Ä—è–º—É
- –í—Å—ñ —Ñ—É–Ω–∫—Ü—ñ—ó G Hub –¥–æ—Å—Ç—É–ø–Ω—ñ
- –ù–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–æ–∑–±–∏—Ä–∞—Ç–∏—Å—å –≤ HID –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ

‚úÖ **–î–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞:**
- –ü—Ä–æ–∑–æ—Ä–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞
- –õ–µ–≥–∫–æ —Ä–æ–∑—à–∏—Ä—é–≤–∞—Ç–∏
- –ú–æ–¥—É–ª—å–Ω–∏–π –∫–æ–¥

‚úÖ **–î–ª—è —Å–∏—Å—Ç–µ–º–∏:**
- –ù–∏–∑—å–∫–∞ –∑–∞—Ç—Ä–∏–º–∫–∞
- –ù–∞—Ç–∏–≤–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –û–°
- –°—É–º—ñ—Å–Ω—ñ—Å—Ç—å –∑ –±—É–¥—å-—è–∫–∏–º –ü–ó

## üìû –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–Ø–∫—â–æ —â–æ—Å—å –Ω–µ –ø—Ä–∞—Ü—é—î:
1. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ `QUICKSTART_LOGITECH.md`
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ `PASSTHROUGH_UA.md` –¥–ª—è –¥–µ—Ç–∞–ª–µ–π
3. –ü–æ–¥–∏–≤—ñ—Ç—å—Å—è Serial Monitor –¥–ª—è debug –ª–æ–≥—ñ–≤
4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ –≤—Å—ñ —Ñ–∞–π–ª–∏ —Å–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω—ñ

## üöÄ –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

–ü—ñ—Å–ª—è –±–∞–∑–æ–≤–æ–≥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:
1. –°–ø—Ä–æ–±—É–π—Ç–µ —Ä—ñ–∑–Ω—ñ –ø—Ä–æ—Ñ—ñ–ª—ñ –≤ G Hub
2. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ DPI levels
3. –î–æ–¥–∞–π—Ç–µ –º–∞–∫—Ä–æ—Å–∏ —á–µ—Ä–µ–∑ HID Remapper
4. –ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É–π—Ç–µ –∑ GPIO –≤–∏—Ö–æ–¥–∞–º–∏

---

**–ì–æ—Ç–æ–≤–æ!** –¢–µ–ø–µ—Ä –≤–∞—à–∞ Logitech –º–∏—à–∞ –ø—Ä–∞—Ü—é—î –∑ G Hub —á–µ—Ä–µ–∑ RP2350! üéÆ‚ú®

–°—Ç–≤–æ—Ä–µ–Ω–æ –¥–ª—è –ø—Ä–æ–µ–∫—Ç—É HID Remapper - https://github.com/jfedor2/hid-remapper

